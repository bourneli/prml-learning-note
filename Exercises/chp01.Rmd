---
title: "PRML-Exercises-Chapter-01"
author: "bourneli"
output: html_document
---
# 1.1 (*)  

计算损失函数的最优解，
$E(w)=\frac{1}{2}\sum_{n=1}^{N}(\sum_{j=0}^{M}w_jx_n^j-t_n)^2$

偏导数为0，
$$\frac{\partial E(w)}{w_i}
  = \sum_{n=1}^{N}(\sum_{j=0}^{M}w_jx_n^j-t_n)x_n^i
  = 0
$$

最后化简，得到最终答案,注意左边两个$\Sigma$可以交换位置的。

$$
  \sum_{n=1}^{N}\sum_{j=0}^{M}w_jx_n^{i+j} 
  = \sum_{j=0}^{M}w_j\sum_{n=1}^{N}x_n^{i+j} 
  =\sum_{j=0}^{M}w_jA_{ij} = \sum_{n=1}^{N}t_nx_n^i=T_i
$$

# 1.2 (*)



与1.1题类似，考察了在L2正规化情况下的最有计算方案，此时损失函数为

$$
  \widetilde{E}(w)=\frac{1}{2}\sum_{n=1}^{N}(\sum_{j=0}^{M}w_jx_n^j-t_n)^2
   + \frac{\lambda}{2}\|w\|^2
$$


此时引入了一个参数$\lambda$，人工输入。仍然求偏导，

$$\frac{\partial \widetilde{E}(w)}{w_i}
  = \sum_{n=1}^{N}(\sum_{j=0}^{M}w_jx_n^j-t_n)x_n^i + \lambda w_i
  = 0
$$

其他类似，这里省略。

# 1.3 (*)

苹果的概率列举所有可能，使用条件概率即可

$$
  p(apple) = p(red)p(apple|red) + p(blue)p(apple|blue) + p(green)p(apple|green) \\
           = 0.2 \times 0.3 + 0.2 \times 0.5 + 0.6 \times 0.3 = 0.34
$$


在得到橘子的情况下，计算从绿色罐中得到概率不太好计算，但是可以用贝叶斯计算这个后置概率。这里要强调一点，**前置概率**，即任何一个水果从绿色罐中得到的概率是0.6。

$$
  p(green|orange) = \frac{p(orange|green)p(green)}{p(orange)} \\
                  = \frac{0.3 \times 0.6}{0.2\times 0.4 + 0.2 \times 0.5 + 0.6 \times 0.3}  = 0.5
$$

可以发现，这个后验概率比先验概率要小。因为橘子在绿色的概率比较小，拖了绿色先验概率的后腿。


# 1.5 (*)

考察期望计算符号性质

$$
  \begin{align}
  var[f(x)] &= E[(f(x)-E[f(x)])^2] \\
            &= E[(f(x))^2+E[f(x)]^2-2f(x)E[f(x)]] \\
            &= E[(f(x))^2]+E[f(x)]^2-2E[f(x)]E[f(x)] \\
            &= E[(f(x))^2]-E[f(x)]^2
  \end{align}
$$

# 1.6 (*)

仍然考察期望符号性质，协方差按性质展开,x,y独立有$E(xy)=E(x)E(y)$

$$
  \begin{align}
    cov(x,y) &= E[(x-\bar{x}(y-\bar{y})] \\
            &= E[xy]- 2\bar{x}\bar{y}+\bar{x}\bar{y} \\
            &= E[x]E[y] - \bar{x}\bar{y} = 0
  \end{align}
$$


# 1.11 (*)

考察使用最大释然法求解正太分布的过程。目标函数如下

$$
  J(\mu, \sigma^2) = \ln{p(X|\mu,\sigma^2)} 
  = -\frac{1}{2\sigma^2}\sum_{n=1}^{N}(x_n-\mu)^2-\frac{N}{2}\ln{\sigma^2}-\frac{N}{2}\ln{(2\pi)}
$$


目标函数对$\mu$求偏导，并且等于0
$$
  \frac{\partial{J(\mu,\sigma^2)}}{\partial{\mu}}
  = \frac{1}{\sigma^2}\sum_{n=1}^{N}{(x_n-\mu)} = 0
  \Rightarrow \mu=\frac{1}{N}\sum_{n=1}^{N}x_n
$$



目标函数对$\sigma^2$求偏导(**不是$\sigma$**)，并且等于0，

$$
   \frac{\partial{J(\mu,\sigma^2)}}{\partial{\sigma^2}} 
   = \frac{1}{2(\sigma^2)^2}\sum_{n=1}^{N}(x_n-\mu)^2-\frac{N}{2\sigma^2} = 0
   \Rightarrow \sigma^2 = \frac{1}{N}\sum_{n=1}^{N}(x_n-\mu)^2
$$


# 1.12 (**)

这个问题解释了为什么用$\frac{\frac{1}{N}\sum_{n=1}^{N}(x_n-\mu)^2}{n-1}$来评估正太分布的方差，其中$\mu$是样本均值。